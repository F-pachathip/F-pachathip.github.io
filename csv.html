<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CSV Vault ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV (‡∏Å‡∏î‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)</title>

  <style>
    :root{
      --bg:#0b1220; --panel:#0f1930; --text:#e7eaf1; --muted:#a8b2c1;
      --border:#243149; --ring:#7fb0ff; --ok:#22c55e; --accent:#4d83ff;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:
      radial-gradient(900px 500px at 10% -10%, #1b2a5a 0, transparent 60%),
      radial-gradient(900px 500px at 110% 10%, #0e4a72 0, transparent 60%), var(--bg);
      color:var(--text); font-family:system-ui, -apple-system, "Segoe UI", Arial, sans-serif;}
    .wrap{max-width:980px; margin:28px auto; padding:0 16px}
    .title{font-weight:700; font-size:20px; margin:0 0 8px}
    .sub{color:var(--muted); margin:0 0 18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--border); border-radius:14px; padding:14px; box-shadow:0 10px 30px #0005;}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn{display:inline-flex; align-items:center; gap:8px; border:1px solid var(--border);
      background:#0f1b33; color:var(--text); padding:10px 14px; border-radius:12px; cursor:pointer; text-decoration:none; user-select:none}
    .btn:hover{background:#152849}
    .btn-primary{background:linear-gradient(180deg, var(--accent), #2f6bff); border-color:#2f6bff}
    .btn-ghost{background:transparent}
    .badge{display:inline-block; padding:4px 8px; border-radius:999px;
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); color:#cfe1ff; font-size:12px}
    .list{margin:14px 0 0; display:grid; gap:12px}
    .item{display:flex; gap:12px; align-items:center; justify-content:space-between;
      padding:12px; border:1px solid var(--border); border-radius:12px; background:#0e1830}
    .meta{display:flex; gap:10px; align-items:center; min-width:0}
    .name{font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:52vw}
    .muted{color:var(--muted)}
    details{margin-top:8px}
    summary{cursor:pointer; color:#cfe1ff}
    pre{background:#0b1430; border:1px solid #1f2a4a; padding:10px; border-radius:10px; overflow:auto; margin:8px 0 0}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">CSV Vault</h1>
    <p class="sub">‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ó‡∏µ‡πà‡∏ù‡∏±‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î/‡∏•‡∏≤‡∏Å‡∏ß‡∏≤‡∏á</p>

    <div class="card">
      <div class="row" style="justify-content:space-between">
        <div class="row">
          <span class="badge" id="kCount">0 ‡πÑ‡∏ü‡∏•‡πå</span>
          <span class="badge" id="kSize">‡∏£‡∏ß‡∏° 0 KB</span>
        </div>
        <button class="btn btn-primary" id="downloadAllBtn" aria-label="‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå</button>
      </div>

      <div class="list" id="fileList" aria-live="polite"></div>
    </div>
  </div>

  <script>
    // =========================
    // üîß ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    // - name: ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
    // - content: ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ CSV ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    // =========================
    const FILES = [
      {
        name: "salesdata_missing4.csv",
        content:
`sale_id,date,brand,model,devices,usd_price
S24001,2024-01-05,Apple,iPhone 15,phone,999
S24002,2024-01-07,Samsung,Galaxy S24,phone,899
S24003,2024-02-10,Lenovo,E310 True Wireless,headphones,39
S24004,2024-03-02,Huawei, MatePad 11,tablet,329
S24xxx,2024-05-15,Apple,MacBook Air 13,notebook,1099`
      },
      {
        name: "devices_catalog.csv",
        content:
`brand,phone,tablet,headphones,notebook
Apple,iPhone 15,iPad Air,AirPods Pro 2,MacBook Air 13
Samsung,Galaxy S24,Galaxy Tab S9,Galaxy Buds2,Galaxy Book3
Huawei,P60,MatePad 11,FreeBuds 5, MateBook 14
Lenovo,Legion Phone,Yoga Tab,Pulse 3D,E310 True Wireless`
      },
      {
        name: "regions_prices_2024.csv",
        content:
`region,currency,fx_usd,remark
US,USD,1,base
EU,EUR,0.92,approx
TH,THB,35.2,mid-2024`
      }
    ];

    // ===== Helpers =====
    const $ = (s,ctx=document)=>ctx.querySelector(s);
    const humanSize = (bytes)=>{
      if(bytes < 1024) return bytes + ' B';
      const kb = bytes/1024;
      if(kb < 1024) return kb.toFixed(1)+' KB';
      const mb = kb/1024;
      return mb.toFixed(2)+' MB';
    };
    const fileSizeFromString = (str)=> new Blob([str]).size;

    function downloadText(filename, text){
      const blob = new Blob([text], {type:'text/csv;charset=utf-8;'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      URL.revokeObjectURL(a.href);
      a.remove();
    }

    function previewLines(text, n=10){
      return text.split(/\r?\n/).slice(0, n).join('\n');
    }

    // ===== Render =====
    function render(){
      const list = $('#fileList');
      list.innerHTML = '';

      let totalBytes = 0;

      FILES.forEach((f, idx)=>{
        const size = fileSizeFromString(f.content);
        totalBytes += size;

        const item = document.createElement('div');
        item.className = 'item';

        const meta = document.createElement('div');
        meta.className = 'meta';
        const name = document.createElement('div');
        name.className = 'name';
        name.textContent = f.name;

        const sizeEl = document.createElement('div');
        sizeEl.className = 'muted';
        sizeEl.textContent = humanSize(size);

        meta.append(name, sizeEl);

        const actions = document.createElement('div');
        actions.className = 'row';

        const btnDl = document.createElement('button');
        btnDl.className = 'btn';
        btnDl.setAttribute('aria-label', `‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î ${f.name}`);
        btnDl.textContent = '‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î';
        btnDl.addEventListener('click', ()=> downloadText(f.name, f.content));

        const det = document.createElement('details');
        const sum = document.createElement('summary');
        sum.textContent = '‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß (10 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å)';
        const pre = document.createElement('pre');
        pre.textContent = previewLines(f.content, 10);
        det.append(sum, pre);

        actions.append(btnDl);
        item.append(meta, actions);
        list.appendChild(item);
        list.appendChild(det);
      });

      $('#kCount').textContent = `${FILES.length} ‡πÑ‡∏ü‡∏•‡πå`;
      $('#kSize').textContent = `‡∏£‡∏ß‡∏° ${humanSize(totalBytes)}`;
    }

    // ===== Download All (‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå) =====
    $('#downloadAllBtn').addEventListener('click', ()=>{
      // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ö‡∏£‡∏≤‡∏ß‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏•‡∏¥‡∏Å
      (async function run(){
        for(const f of FILES){
          downloadText(f.name, f.content);
          // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ event ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏ß‡∏°
          // (‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡πÅ‡∏ï‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ UX ‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ)
          await new Promise(r=>setTimeout(r, 120));
        }
      })();
    });

    render();
  </script>
</body>
</html>
